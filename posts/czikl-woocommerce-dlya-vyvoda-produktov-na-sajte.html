<!doctype html>
<html lang="ru">
  <head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HC09CY02N9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HC09CY02N9');
</script>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#787878">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="theme-color" content="#ffffff">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
	<link rel="stylesheet" href="../assets/css/style.css">

    <title>Примеры циклов для вывода товаров WooCommerce на сайте WordPress &mdash; Uzabila</title>
  </head>
<body class="position-relative">

<!-- navbar section -->
<section class="navbar-section py-3 py-md-5">
	<nav class="navbar navbar-expand-lg navbar-light bg-white">
		<div class="container">
			<a class="navbar-brand d-flex gap-3 align-items-center" href="../rus/">
				<img src="../assets/images/sergei-150.png" alt="" width="80" height="80" class="d-inline-block align-middle">
				<div class="logo-block"><span class="fw-bold">Сергей Ермилов</span><br><span class="small-font">Uzabila</span></div>
			</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav ms-0 ms-md-5 mb-2 mb-lg-0">

					<li class="nav-item">
						<a class="nav-link" title="GitHub" target="_blank" href="https://github.com/uzabila"><img src="../assets/images/gh.svg" alt="GitHub" width="32" height="32" class="mx-3" style="margin-top:-5px"></a>
					</li>

					<li class="nav-item">
						<a class="nav-link" href="./index.html#about">Обо мне</a>
					</li>

					<li class="nav-item">
						<a class="nav-link" href="../rus/index.html#work">Услуги</a>
					</li>

                    <li class="nav-item">
						<a class="nav-link" href="../rus/portfolio.html">Портфолио</a>
					</li>

                    <li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
						  Журнал
						</a>
						<ul class="dropdown-menu" aria-labelledby="navbarDropdown">
						  <li><a class="dropdown-item" href="../posts/">Статьи</a></li>
						  <li><a class="dropdown-item" href="../rus/101book.html">Книга</a></li>
						  <li><hr class="dropdown-divider"></li>
						  <li><a class="dropdown-item" href="../snippets/">Сниппеты</a></li>
						</ul>
					</li>
					
					<li class="nav-item">
						<a class="nav-link" href="../rus/index.html#contacts">Контакты</a>
					</li>
				</ul>
				<div class="dropdown-lang ms-auto">
				<button onclick="myFunction()" class="dropbtn"><img src="/assets/svg/ru.svg" alt="Русский" width="24" height="16"> Русский <i class="bi bi-arrow-90deg-down"></i></button>
				<div id="myDropdown" class="dropdown-content">
					<a href="../"><img src="/assets/svg/gb.svg" alt="English" width="12" height="8"> English <i class="bi bi-arrow-up-right-square"></i></a>
				</div>
				</div>

			</div>
		</div>
	</nav>
</section>
<!-- end navbar section -->

    <!-- POSTS -->
    <div class="container" id="posts">
        <div class="row mb-5">
            <div class="col-12 col-md-8 offset-md-2">
                <span><small><a href="index.html">Все статьи</a></small></span>
                <h1>Примеры циклов для вывода товаров WooCommerce на сайте WordPress</h1>
            </div>
        </div>
    </div>
    <!-- END POSTS -->

    <div class="container" id="portfolio">
        <div class="row mb-5">
            <div class="col-12 col-md-8 offset-md-2">

                <p class="text-muted"><small>Опубликовано 29 апреля 2024 в 23:57</small></p>

                <p>WooCommerce - это самое быстрорастущее решение для электронной коммерции в Интернете для системы управления сайтом WordPress.</p>

                <p>Существуют тысячи тем WooCommerce, которые помогут вам создать свой магазин, но что, если вы хотите настроить уникальное отображение товаров на сайтах ваших клиентов. Понимание того, как WooCommerce отображает товары на разных страницах - первый шаг к уникализации темы для ваших заказчиков.</p>

                <h2>Цикл для отображения товаров WooCommerce</h2>

                <p>Когда на странице магазина WooCommerce отображается список товаров, код, который выводит список товаров, называется «Циклом товаров». Терминология напоминает цикл записей в блоге WordPress, где список записей выводится на страницах блога и архива. Принцип работы тот же.</p>

                <p>Концепция кода довольно проста даже для понимания теми, кто почти не имеет опыта разработки. Цикл проверяет, не осталось ли еще товаров (при определенных условиях) для отображения.</p>

                <p>Если они есть, детали продукта берутся из базы данных, выводятся на экран, а затем процесс перезапускается или зацикливается до тех пор, пока не останется ни одного продукта для отображения по заданным условиям.</p>

                <h2>Важность цикла товаров</h2>

                <p>Бывают обстоятельства, когда вам нужно отобразить список определенных товаров на странице, что невозможно сделать с помощью обычных шорткодов, которые идут вместе с самим плагином.</p>

                <p>В этом случае вам, скорее всего, потребуется вставить код пользовательского цикла товаров в шаблон страницы магазина. Каждая тема WooCommerce и плагин поиска и фильтрации используют пользовательские циклы для отображения результатов поиска товаров.</p>

                <h2>Где найти цикл товаров WooCommerce?</h2>

                <p>Цикл товаров WooCommerce эволюционировал за последние четыре-пять лет, с тех пор как Automatic приобрела WooCommerce. Ушел в прошлое один небольшой кусок кода, выводивший комбинацию PHP вперемешку с HTML.</p>

                <p>Теперь цикл товаров WooCommerce - это усовершенствованный, подключаемый модуль. Лучше всего найти дефолтный цикл товаров WooCommerce в файле шаблона: <strong>/template/archive-product.php</strong>.</p>

                <p>Папка <strong>/template/</strong> в плагине WooCommere содержит шаблоны, которые вы можете скопировать в свою дочернюю тему, чтобы настроить определенные страницы WooCommerce.</p>

                <p>Также вы можете просмотреть файл <strong>archive-product.php</strong> по адресу:</p>

                <pre style="font-family:monospace;color: rgb(68, 68, 68); background-color: rgb(243, 243, 243); font-weight: 400; "><span style="color: rgb(68, 68, 68); font-weight: 700;">https</span>://github.com/woocommerce/woocommerce/blob/<span style="color: rgb(136, 0, 0); font-weight: 400;">6</span>.<span style="color: rgb(136, 0, 0); font-weight: 400;">5</span>.<span style="color: rgb(136, 0, 0); font-weight: 400;">0</span>/plugins/woocommerce/templates/archive-product.php</pre>

                <h2>Код цикла товаров WooCommerce</h2>

                <p>Я удалил многие комментарии из исходного кода, чтобы показать простоту текущего цикла.</p>

                <pre style="font-family:monospace;color: rgb(0, 0, 0); background-color: #f5f5f5; font-weight: 400; "><span style="color: rgb(43, 145, 175); font-weight: 400;">&lt;?php</span> <span style="color: rgb(0, 0, 255); font-weight: 400;">if</span> ( <span style="color: rgb(163, 21, 21); font-weight: 400;">woocommerce_product_loop</span>() ) {
                    <span style="color: rgb(163, 21, 21); font-weight: 400;">do_action</span>( <span style="color: rgb(163, 21, 21); font-weight: 400;">'woocommerce_before_shop_loop'</span> );
                    <span style="color: rgb(163, 21, 21); font-weight: 400;">woocommerce_product_loop_start</span>();
                    <span style="color: rgb(0, 0, 255); font-weight: 400;">if</span> ( <span style="color: rgb(163, 21, 21); font-weight: 400;">wc_get_loop_prop</span>( <span style="color: rgb(163, 21, 21); font-weight: 400;">'total'</span> ) ) {
                        <span style="color: rgb(0, 0, 255); font-weight: 400;">while</span> ( <span style="color: rgb(163, 21, 21); font-weight: 400;">have_posts</span>() ) {
                            <span style="color: rgb(163, 21, 21); font-weight: 400;">the_post</span>();
                            <span style="color: rgb(163, 21, 21); font-weight: 400;">do_action</span>( <span style="color: rgb(163, 21, 21); font-weight: 400;">'woocommerce_shop_loop'</span> );
                            <span style="color: rgb(163, 21, 21); font-weight: 400;">wc_get_template_part</span>( <span style="color: rgb(163, 21, 21); font-weight: 400;">'content'</span>, <span style="color: rgb(163, 21, 21); font-weight: 400;">'product'</span> );
                        }
                    }
                    <span style="color: rgb(163, 21, 21); font-weight: 400;">woocommerce_product_loop_end</span>();
                    <span style="color: rgb(163, 21, 21); font-weight: 400;">do_action</span>( <span style="color: rgb(163, 21, 21); font-weight: 400;">'woocommerce_after_shop_loop'</span> );
                } <span style="color: rgb(0, 0, 255); font-weight: 400;">else</span> {
                    <span style="color: rgb(163, 21, 21); font-weight: 400;">do_action</span>( <span style="color: rgb(163, 21, 21); font-weight: 400;">'woocommerce_no_products_found'</span> );
                }</pre>

                <p>Я объясню, что происходит в коде на верхнем уровне.</p>

                <p>Сам цикл товаров окружен условным оператором <code>if</code>, строки <strong>1</strong>, <strong>13</strong> и <strong>15</strong>, который проверяет, является ли это циклом товаров WooCommerce; в противном случае он сообщает браузеру, что в строке <strong>14</strong> товаров не найдено.</p>

                <p>Строки <strong>2</strong> и <strong>12</strong> позволяют подключить или запустить свои функции для вывода содержимого непосредственно до и после цикла товаров, используя имена хуков WordPress <code>woocommerce_before_shop_loop</code> и <code>woocommerce_after_shop_loop</code>.</p>

                <p>Не волнуйтесь, если вы не знаете, как использовать хуки WordPress, просто знайте, что это возможно. Строки <strong>3</strong> и <strong>11</strong> запускают и завершают цикл товаров WooCommerce соответственно.</p>

                <p>Функция <code>woocommerce_product_loop_start</code> устанавливает указатели и счетчики и подготавливает базу данных WordPress для запроса.</p>

                <p>Функция <code>woocommerce_product_loop_end</code> закрывает соединение с базой данных, сбрасывает указатели и приводит все в порядок, готовясь к очередному запросу WordPress.</p>

                <p>Строки <strong>4</strong> и <strong>10</strong> содержат условный оператор, проверяющий, сколько всего товаров находится в базе данных, и выполняющий код внутри оператора только в том случае, если общее количество товаров больше нуля.</p>

                <p>Наконец, в строках с <strong>5</strong> по <strong>9</strong> запускается собственно цикл вывода товаров WooCommerce, в котором информация о товарах извлекается из базы данных и выводится в браузер.</p>

                <p>Строка 8 вызывает другой шаблон, <strong>/templates/content-product.php</strong>, для вывода данных о товарах.</p>

                <p>Вы можете посмотреть этот шаблон онлайн здесь:</p>

                <pre style="font-family:monospace;color: rgb(84, 84, 84); background-color: #f5f5f5; font-weight: 400; "><span style="color: rgb(170, 93, 0); font-weight: 400;">https</span>://github.com/woocommerce/woocommerce/blob/<span style="color: rgb(170, 93, 0); font-weight: 400;">6</span>.<span style="color: rgb(170, 93, 0); font-weight: 400;">5</span>.<span style="color: rgb(170, 93, 0); font-weight: 400;">0</span>/plugins/woocommerce/templates/content-product.php</pre>

                <h2>Альтернативный пользовательский цикл товаров WooCommerce</h2>

                <p>Документация WooCommerce довольно хороша, и у них есть альтернативный пример кода для пользовательского цикла товаров WooCommerce:</p>

                <pre style="font-family:monospace;color: rgb(0, 0, 0); background-color: #f5f5f5; font-weight: 400; ">&lt;ul <span style="color: rgb(0, 0, 0); font-weight: 400;"><span style="color: rgb(170, 13, 145); font-weight: 400;">class</span>="<span style="color: rgb(28, 0, 207); font-weight: 400;">products</span>"&gt;
                    &lt;?<span style="color: rgb(28, 0, 207); font-weight: 400;">php</span>
                        $<span style="color: rgb(28, 0, 207); font-weight: 400;">args</span> = <span style="color: rgb(28, 0, 207); font-weight: 400;">array</span>(
                            '<span style="color: rgb(28, 0, 207); font-weight: 400;">post_type</span>' =&gt; '<span style="color: rgb(28, 0, 207); font-weight: 400;">product</span>',
                            '<span style="color: rgb(28, 0, 207); font-weight: 400;">posts_per_page</span>' =&gt; 12
                            );
                        $<span style="color: rgb(28, 0, 207); font-weight: 400;">loop</span> = <span style="color: rgb(28, 0, 207); font-weight: 400;">new</span> <span style="color: rgb(28, 0, 207); font-weight: 400;">WP_Query</span>( $<span style="color: rgb(28, 0, 207); font-weight: 400;">args</span> );
                        <span style="color: rgb(28, 0, 207); font-weight: 400;">if</span> ( $<span style="color: rgb(28, 0, 207); font-weight: 400;">loop</span>-&gt;<span style="color: rgb(28, 0, 207); font-weight: 400;">have_posts</span>() ) </span>{
                            <span style="color: rgb(170, 13, 145); font-weight: 400;">while</span> ( <span style="color: rgb(63, 110, 116); font-weight: 400;">$loop</span>-&gt;<span style="color: rgb(28, 0, 207); font-weight: 400;">have_posts</span>() ) : <span style="color: rgb(63, 110, 116); font-weight: 400;">$loop</span>-&gt;<span style="color: rgb(28, 0, 207); font-weight: 400;">the_post</span>();
                                <span style="color: rgb(28, 0, 207); font-weight: 400;">wc_get_template_part</span>( <span style="color: rgb(196, 26, 22); font-weight: 400;">'content'</span>, <span style="color: rgb(196, 26, 22); font-weight: 400;">'product'</span> );
                            <span style="color: rgb(170, 13, 145); font-weight: 400;">endwhile</span>;
                        } <span style="color: rgb(170, 13, 145); font-weight: 400;">else</span> {
                            <span style="color: rgb(170, 13, 145); font-weight: 400;">echo</span> <span style="color: rgb(28, 0, 207); font-weight: 400;">__</span>( <span style="color: rgb(196, 26, 22); font-weight: 400;">'No products found'</span> );
                        }
                        <span style="color: rgb(28, 0, 207); font-weight: 400;">wp_reset_postdata</span>();
                    <span style="color: rgb(100, 56, 32); font-weight: 400;">?&gt;</span>
                &lt;/ul&gt;</pre>

                <p>Приведенный выше код очень похож на тот, который мы рассмотрели выше, но вместо того, чтобы использовать все эти функции WooCommerce для настройки, этот фрагмент кода использует объект <code>WP_Query</code> для настройки запроса к базе данных для получения данных о товаре.</p>

                <p>Критерии поиска товаров задаются в массиве <code>$arg</code> в строках <strong>3-6</strong>.</p>

                <p>В приведенном выше фрагменте кода запрос ищет записи типа <code>'product'</code>, а пагинация страниц настроена так, чтобы возвращать 12 товаров на страницу. Вы можете настроить условия запроса, добавив условия в переменную <code>$arg</code>.</p>

                <p> Ознакомьтесь с документацией WP_Query по адресу:</p>

                <pre style="font-family:monospace;color: rgb(84, 84, 84); background-color: #f5f5f5; font-weight: 400; "><span style="color: rgb(170, 93, 0); font-weight: 400;">https</span>://developer.wordpress.org/reference/classes/wp_query/</pre>

                <h2>Заключение</h2>

                <p>В цикле товаров WooCommerce есть много деталей, которые я исключил из этого материала, чтобы он получился более понятным для начинающих разработчиков.</p>

                <p>Чтобы настроить цикл товаров WooCommerce, вам нужно будет понять, как использовать хуки и фильтры WordPress. Но подробнее об этом мы поговорим в следующих статьях.</p>

            </div>
        </div>
    </div>

    <section id="contacts" class="py-5">
        <div class="container">
            <div class="row mb-5">
                <div class="col-12 col-md-6">
                    <h2 class="fw-bold mb-3 mb-md-4 mb-lg-5"><span class="gradient-title fw-800">Связь со мной</span> <i class="bi bi-arrow-right pot"></i></h2>
    
                    <p class="main-links">Я готов к работе. У вас есть проект для меня, вопросы или вы хотите сделать заказ? Вы можете написать мне на электронную почту или посетить мою страницу на <a href="https://kwork.ru/user/uzabila?ref=330782" target="_blank">Кворке</a>.</p>
    
                    <p class="social-links pt-4">
                        <a href="https://github.com/uzabila" target="_blank" title="GitHub" class="me-2"><img src="../assets/images/gh.svg" alt="GitHub" width="24" height="24"></a>
                        <a href="https://www.behance.net/uzabila" target="_blank" title="Behance" class="me-2"><img src="../assets/images/bh.svg" alt="Behance" width="24" height="24"></a> 
                        <a href="https://dribbble.com/uzabila" target="_blank" title="Dribbble" class="me-0"><img src="../assets/images/dribbble.svg" alt="Dribbble" width="24" height="24"></a>
                    </p>
                    
                </div>
                <div class="col-12 col-md-6 text-start text-md-end">
                    <h3 class="fw-bold h1">uzabila@yandex.ru</h3>
                </div>
            </div>	
        </div>
    </section>
    
    <footer class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-12 col-md-4 my-auto">
                    <span class="fw-500 text-muted">uzabila.github.io</span>
                </div>
                <div class="col-12 col-md-4 text-center my-auto">
                    <img src="../assets/images/sergei-150.png" alt="Sergei Ermilov" width="80" height="80">
                </div>
                <div class="col-12 col-md-4 my-auto text-end">
                    <span class="fw-500 text-muted">2008 - 2024 &copy; Uzabila</span>
                </div>
            </div>
        </div>
    </footer>
    
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/app.js"></script>
    
      </body>
    </html>